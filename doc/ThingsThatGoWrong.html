<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Carl James Schwarz" />

<meta name="date" content="2019-11-29" />

<title>Things that can go wrong</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Things that can go wrong</h1>
<h4 class="author">Carl James Schwarz</h4>
<h4 class="date">2019-11-29</h4>


<div id="TOC">
<ul>
<li><a href="#things-that-can-go-wrong."><span class="toc-section-number">1</span> Things that can go wrong.</a><ul>
<li><a href="#rows-are-proportional"><span class="toc-section-number">1.1</span> Rows are proportional</a></li>
<li><a href="#rows-are-approximately-proportional"><span class="toc-section-number">1.2</span> Rows are approximately proportional</a></li>
</ul></li>
<li><a href="#columns-that-are-all-zero"><span class="toc-section-number">2</span> Columns that are all zero</a></li>
<li><a href="#references"><span class="toc-section-number">3</span> References</a></li>
</ul>
</div>

<div id="things-that-can-go-wrong." class="section level1">
<h1><span class="header-section-number">1</span> Things that can go wrong.</h1>
<p>There are several types of problem that can occur that make the use of SPAS problematic.</p>
<div id="rows-are-proportional" class="section level2">
<h2><span class="header-section-number">1.1</span> Rows are proportional</h2>
<p>If the row in the movement matrix are proportional, then there an infinite number of solutions. Note it is the singularity of the movement matrix that is problematic; the number of tags releases and not recovered (last column of the input data) can be proportional without affecting the fit.</p>
<p>The model may converge to different solutions depending on your set up. There is no automatic “flagging” of this situation and you need to be vigilant. A diagnostic tool is the condition number of <span class="math inline">\(XX&#39;\)</span> where <span class="math inline">\(X\)</span> is the movement matrix. If the rows are exactly proportional (or more generally if the rows are colinear) the condition number will be <span class="math inline">\(+\infty\)</span>.</p>
<p>The solution is to pool the row(s) that are proportional.</p>
<p>Here are some examples:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"></a>
<a class="sourceLine" id="cb1-2" title="2">test.data.csv &lt;-<span class="st"> </span><span class="kw">textConnection</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="st"> 160   ,   120   ,     72   ,     82   ,   3592</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="st">  80   ,    60   ,     36   ,     41   ,    532</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="st">7960   ,  9720   ,   6264   ,   7934   ,   0  &quot;</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">test.data &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(test.data.csv, <span class="dt">header=</span><span class="ot">FALSE</span>, <span class="dt">strip.white=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-8" title="8">test.data</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;        V1   V2   V3   V4   V5</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; [1,]  160  120   72   82 3592</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; [2,]   80   60   36   41  532</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; [3,] 7960 9720 6264 7934    0</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14">mod..<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">SPAS.fit.model</span>(test.data,</a>
<a class="sourceLine" id="cb1-15" title="15">                       <span class="dt">model.id=</span><span class="st">&quot;No restrictions&quot;</span>,</a>
<a class="sourceLine" id="cb1-16" title="16">                       <span class="dt">row.pool.in=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">col.pool.in=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">#&gt; Using nlminb to find conditional MLE</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">#&gt; outer mgc:  21233.77 </span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">#&gt; outer mgc:  31337.35 </span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">#&gt; outer mgc:  29620.78 </span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co">#&gt; outer mgc:  7736.026 </span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">#&gt; outer mgc:  1637.496 </span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co">#&gt; outer mgc:  77.12751 </span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">#&gt; outer mgc:  4.863 </span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">#&gt; outer mgc:  0.1203054 </span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">#&gt; outer mgc:  0.04505754 </span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">#&gt; outer mgc:  0.01671065 </span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">#&gt; Convergence codes from nlminb  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">#&gt; Finding conditional estimate of N</span></a>
<a class="sourceLine" id="cb1-30" title="30"></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="kw">SPAS.print.model</span>(mod..<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">#&gt; Model Name: No restrictions </span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="co">#&gt;    Date of Fit: 2019-11-29 23:00 </span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co">#&gt;    Version of OPEN SPAS used : SPAS-R 2020-01-01 </span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">#&gt; Raw data </span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="co">#&gt;        V1   V2   V3   V4   V5</span></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="co">#&gt; [1,]  160  120   72   82 3592</span></a>
<a class="sourceLine" id="cb1-39" title="39"><span class="co">#&gt; [2,]   80   60   36   41  532</span></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="co">#&gt; [3,] 7960 9720 6264 7934    0</span></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="co">#&gt; Row pooling setup : 1 2 </span></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="co">#&gt; Col pooling setup : 1 2 3 4 </span></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="co">#&gt; Physical pooling  : TRUE </span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="co">#&gt; Theta pooling     : FALSE </span></a>
<a class="sourceLine" id="cb1-46" title="46"><span class="co">#&gt; CJS pooling       : FALSE </span></a>
<a class="sourceLine" id="cb1-47" title="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-49" title="49"><span class="co">#&gt; Chapman estimator of population size  238286  (SE  8578  )</span></a>
<a class="sourceLine" id="cb1-50" title="50"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb1-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-52" title="52"><span class="co">#&gt; Raw data AFTER PHYSICAL (but not logical) POOLING </span></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="co">#&gt;       pool1 pool2 pool3 pool4   V5</span></a>
<a class="sourceLine" id="cb1-54" title="54"><span class="co">#&gt; pool1   160   120    72    82 3592</span></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="co">#&gt; pool2    80    60    36    41  532</span></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="co">#&gt;        7960  9720  6264  7934    0</span></a>
<a class="sourceLine" id="cb1-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="co">#&gt; Condition number of XX&#39; where X= (physically) pooled matrix is  4.785754e+16 </span></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="co">#&gt; Condition number of XX&#39; after logical pooling                   4.785754e+16 </span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-61" title="61"><span class="co">#&gt; Large value of kappa (&gt;1000) indicate that rows are approximately proportional which is not good</span></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-63" title="63"><span class="co">#&gt;   Conditional   Log-Likelihood: 285758.5    ;  np: 12 ;  AICc: -571493 </span></a>
<a class="sourceLine" id="cb1-64" title="64"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-65" title="65"><span class="co">#&gt;   Code/Message from optimization is:  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb1-66" title="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-67" title="67"><span class="co">#&gt; Estimates</span></a>
<a class="sourceLine" id="cb1-68" title="68"><span class="co">#&gt;               pool1  pool2  pool3  pool4  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb1-69" title="69"><span class="co">#&gt; pool1         109.1  132.2   85.1  107.7 3592    0.013       73.5  299742</span></a>
<a class="sourceLine" id="cb1-70" title="70"><span class="co">#&gt; pool2          80.0   60.0   36.0   41.0  532    1.000        0.0     749</span></a>
<a class="sourceLine" id="cb1-71" title="71"><span class="co">#&gt; est unmarked 8011.0 9708.0 6251.0 7908.0    0       NA         NA  300491</span></a>
<a class="sourceLine" id="cb1-72" title="72"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-73" title="73"><span class="co">#&gt; SE of above estimates</span></a>
<a class="sourceLine" id="cb1-74" title="74"><span class="co">#&gt;              pool1 pool2 pool3 pool4  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb1-75" title="75"><span class="co">#&gt; pool1          5.3   6.4   4.2   5.3 59.9    0.001        3.5   14291</span></a>
<a class="sourceLine" id="cb1-76" title="76"><span class="co">#&gt; pool2          8.9   7.7   6.0   6.4 23.1    0.000        0.0       0</span></a>
<a class="sourceLine" id="cb1-77" title="77"><span class="co">#&gt; est unmarked    NA    NA    NA    NA  0.0       NA         NA   13499</span></a>
<a class="sourceLine" id="cb1-78" title="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-79" title="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-80" title="80"><span class="co">#&gt; Chisquare gof cutoff  : 0.1 </span></a>
<a class="sourceLine" id="cb1-81" title="81"><span class="co">#&gt; Chisquare gof value   : 33.49443 </span></a>
<a class="sourceLine" id="cb1-82" title="82"><span class="co">#&gt; Chisquare gof df      : 2 </span></a>
<a class="sourceLine" id="cb1-83" title="83"><span class="co">#&gt; Chisquare gof p       : 5.330621e-08</span></a></code></pre></div>
<p>In this case, it appears that the model has converged, but this is ONE of many possible solutions and cannot be relied upon.</p>
<p>The condition number is very large (!) as expected and shown in the above output:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Compute the condition number of XX&#39;</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3">XX &lt;-<span class="st"> </span>test.data[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(test.data[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb2-4" title="4">XX</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;       [,1]  [,2]</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; [1,] 51908 25954</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; [2,] 25954 12977</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Condition number is</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; Condition number is</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw">kappa</span>(XX)</a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; [1] 4.785754e+16</span></a></code></pre></div>
<p>We will either physically or logically pool rows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">mod..<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">SPAS.fit.model</span>(test.data,</a>
<a class="sourceLine" id="cb3-2" title="2">                       <span class="dt">model.id=</span><span class="st">&quot;No restrictions&quot;</span>,</a>
<a class="sourceLine" id="cb3-3" title="3">                       <span class="dt">row.pool.in=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">col.pool.in=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, </a>
<a class="sourceLine" id="cb3-4" title="4">                       <span class="dt">row.physical.pool=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; Using nlminb to find conditional MLE</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; outer mgc:  31861.11 </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; outer mgc:  31027.39 </span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; outer mgc:  27743.45 </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; outer mgc:  64891.49 </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; outer mgc:  17714.73 </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; outer mgc:  2938.93 </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; outer mgc:  388.7135 </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; outer mgc:  1367.762 </span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; outer mgc:  58.7506 </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; outer mgc:  33.22109 </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; outer mgc:  0.2950866 </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; outer mgc:  0.001589974 </span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; Convergence codes from nlminb  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; Finding conditional estimate of N</span></a>
<a class="sourceLine" id="cb3-20" title="20"></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="kw">SPAS.print.model</span>(mod..<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt; Model Name: No restrictions </span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt;    Date of Fit: 2019-11-29 23:00 </span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt;    Version of OPEN SPAS used : SPAS-R 2020-01-01 </span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt; Raw data </span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co">#&gt;        V1   V2   V3   V4   V5</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">#&gt; [1,]  160  120   72   82 3592</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">#&gt; [2,]   80   60   36   41  532</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">#&gt; [3,] 7960 9720 6264 7934    0</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">#&gt; Row pooling setup : 1 1 </span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">#&gt; Col pooling setup : 1 2 3 4 </span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co">#&gt; Physical pooling  : FALSE </span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#&gt; Theta pooling     : FALSE </span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt; CJS pooling       : FALSE </span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt; Chapman estimator of population size  238286  (SE  8578  )</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#&gt; Raw data AFTER PHYSICAL (but not logical) POOLING </span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">#&gt;        pool1 pool2 pool3 pool4   V5</span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="co">#&gt; pool.1   160   120    72    82 3592</span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#&gt; pool.1    80    60    36    41  532</span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co">#&gt;         7960  9720  6264  7934    0</span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="co">#&gt; Condition number of XX&#39; where X= (physically) pooled matrix is  4.785754e+16 </span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co">#&gt; Condition number of XX&#39; after logical pooling                   1 </span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="co">#&gt; Large value of kappa (&gt;1000) indicate that rows are approximately proportional which is not good</span></a>
<a class="sourceLine" id="cb3-52" title="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-53" title="53"><span class="co">#&gt;   Conditional   Log-Likelihood: 285750.9    ;  np: 11 ;  AICc: -571479.7 </span></a>
<a class="sourceLine" id="cb3-54" title="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-55" title="55"><span class="co">#&gt;   Code/Message from optimization is:  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb3-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-57" title="57"><span class="co">#&gt; Estimates</span></a>
<a class="sourceLine" id="cb3-58" title="58"><span class="co">#&gt;               pool1  pool2  pool3  pool4  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb3-59" title="59"><span class="co">#&gt; pool.1        109.4  132.1   85.0  107.5 3592     0.02         49  201170</span></a>
<a class="sourceLine" id="cb3-60" title="60"><span class="co">#&gt; pool.1         54.7   66.0   42.5   53.7  532     0.02         49   37426</span></a>
<a class="sourceLine" id="cb3-61" title="61"><span class="co">#&gt; est unmarked 8036.0 9702.0 6244.0 7896.0    0       NA         NA  238596</span></a>
<a class="sourceLine" id="cb3-62" title="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-63" title="63"><span class="co">#&gt; SE of above estimates</span></a>
<a class="sourceLine" id="cb3-64" title="64"><span class="co">#&gt;              pool1 pool2 pool3 pool4  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb3-65" title="65"><span class="co">#&gt; pool.1         6.7   8.7   6.7   8.1 59.9    0.001        1.9    7805</span></a>
<a class="sourceLine" id="cb3-66" title="66"><span class="co">#&gt; pool.1         5.5   7.4   6.0   7.2 23.1    0.001        1.9    1452</span></a>
<a class="sourceLine" id="cb3-67" title="67"><span class="co">#&gt; est unmarked    NA    NA    NA    NA  0.0       NA         NA    8603</span></a>
<a class="sourceLine" id="cb3-68" title="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-69" title="69"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-70" title="70"><span class="co">#&gt; Chisquare gof cutoff  : 0.1 </span></a>
<a class="sourceLine" id="cb3-71" title="71"><span class="co">#&gt; Chisquare gof value   : 49.81373 </span></a>
<a class="sourceLine" id="cb3-72" title="72"><span class="co">#&gt; Chisquare gof df      : 3 </span></a>
<a class="sourceLine" id="cb3-73" title="73"><span class="co">#&gt; Chisquare gof p       : 8.753258e-11</span></a></code></pre></div>
<p>This has solved the colinearity problem.</p>
</div>
<div id="rows-are-approximately-proportional" class="section level2">
<h2><span class="header-section-number">1.2</span> Rows are approximately proportional</h2>
<p>Of course with real data, it is highly unlikely that the rows in the recovery matrix will be exactly proportional.</p>
<p>The model may converge to different solutions depending on your set up. There is no automatic “flagging” of this situation and you need to be vigilant. The condition number of <span class="math inline">\(XX&#39;\)</span> may be useful.</p>
<p>The solution is to pool the row(s) that are proportional.</p>
<p>Here are some examples where the entries in row 2 are modified slightly to make the rows only approximately proportional</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"></a>
<a class="sourceLine" id="cb4-2" title="2">test.data.csv &lt;-<span class="st"> </span><span class="kw">textConnection</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st"> 160   ,   120   ,     72   ,     82   ,   3592</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">  75   ,    62   ,     38   ,     35   ,    532</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">7960   ,  9720   ,   6264   ,   7934   ,   0  &quot;</span>)</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">test.data &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(test.data.csv, <span class="dt">header=</span><span class="ot">FALSE</span>, <span class="dt">strip.white=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb4-8" title="8">test.data</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt;        V1   V2   V3   V4   V5</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; [1,]  160  120   72   82 3592</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; [2,]   75   62   38   35  532</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; [3,] 7960 9720 6264 7934    0</span></a>
<a class="sourceLine" id="cb4-13" title="13"></a>
<a class="sourceLine" id="cb4-14" title="14">mod..<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">SPAS.fit.model</span>(test.data,</a>
<a class="sourceLine" id="cb4-15" title="15">                       <span class="dt">model.id=</span><span class="st">&quot;No restrictions&quot;</span>,</a>
<a class="sourceLine" id="cb4-16" title="16">                       <span class="dt">row.pool.in=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">col.pool.in=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt; Using nlminb to find conditional MLE</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; outer mgc:  21468.58 </span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; outer mgc:  31261.98 </span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; outer mgc:  29306.81 </span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt; outer mgc:  8081.517 </span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt; outer mgc:  1632.478 </span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt; outer mgc:  75.28523 </span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt; outer mgc:  4.412961 </span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt; outer mgc:  0.1427219 </span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt; outer mgc:  0.05345935 </span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt; outer mgc:  0.01986673 </span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt; Convergence codes from nlminb  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt; Finding conditional estimate of N</span></a>
<a class="sourceLine" id="cb4-30" title="30"></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="kw">SPAS.print.model</span>(mod..<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-32" title="32"><span class="co">#&gt; Model Name: No restrictions </span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="co">#&gt;    Date of Fit: 2019-11-29 23:00 </span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">#&gt;    Version of OPEN SPAS used : SPAS-R 2020-01-01 </span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co">#&gt; Raw data </span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">#&gt;        V1   V2   V3   V4   V5</span></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">#&gt; [1,]  160  120   72   82 3592</span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#&gt; [2,]   75   62   38   35  532</span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">#&gt; [3,] 7960 9720 6264 7934    0</span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="co">#&gt; Row pooling setup : 1 2 </span></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="co">#&gt; Col pooling setup : 1 2 3 4 </span></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">#&gt; Physical pooling  : TRUE </span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="co">#&gt; Theta pooling     : FALSE </span></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co">#&gt; CJS pooling       : FALSE </span></a>
<a class="sourceLine" id="cb4-47" title="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-48" title="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-49" title="49"><span class="co">#&gt; Chapman estimator of population size  240468  (SE  8710  )</span></a>
<a class="sourceLine" id="cb4-50" title="50"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb4-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-52" title="52"><span class="co">#&gt; Raw data AFTER PHYSICAL (but not logical) POOLING </span></a>
<a class="sourceLine" id="cb4-53" title="53"><span class="co">#&gt;       pool1 pool2 pool3 pool4   V5</span></a>
<a class="sourceLine" id="cb4-54" title="54"><span class="co">#&gt; pool1   160   120    72    82 3592</span></a>
<a class="sourceLine" id="cb4-55" title="55"><span class="co">#&gt; pool2    75    62    38    35  532</span></a>
<a class="sourceLine" id="cb4-56" title="56"><span class="co">#&gt;        7960  9720  6264  7934    0</span></a>
<a class="sourceLine" id="cb4-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-58" title="58"><span class="co">#&gt; Condition number of XX&#39; where X= (physically) pooled matrix is  1785.545 </span></a>
<a class="sourceLine" id="cb4-59" title="59"><span class="co">#&gt; Condition number of XX&#39; after logical pooling                   1785.545 </span></a>
<a class="sourceLine" id="cb4-60" title="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-61" title="61"><span class="co">#&gt; Large value of kappa (&gt;1000) indicate that rows are approximately proportional which is not good</span></a>
<a class="sourceLine" id="cb4-62" title="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-63" title="63"><span class="co">#&gt;   Conditional   Log-Likelihood: 285730.4    ;  np: 12 ;  AICc: -571436.7 </span></a>
<a class="sourceLine" id="cb4-64" title="64"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-65" title="65"><span class="co">#&gt;   Code/Message from optimization is:  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb4-66" title="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-67" title="67"><span class="co">#&gt; Estimates</span></a>
<a class="sourceLine" id="cb4-68" title="68"><span class="co">#&gt;               pool1  pool2  pool3  pool4  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb4-69" title="69"><span class="co">#&gt; pool1         109.1  132.2   85.1  107.7 3592    0.013       73.5  299742</span></a>
<a class="sourceLine" id="cb4-70" title="70"><span class="co">#&gt; pool2          75.0   62.0   38.0   35.0  532    1.000        0.0     742</span></a>
<a class="sourceLine" id="cb4-71" title="71"><span class="co">#&gt; est unmarked 8011.0 9708.0 6251.0 7908.0    0       NA         NA  300484</span></a>
<a class="sourceLine" id="cb4-72" title="72"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-73" title="73"><span class="co">#&gt; SE of above estimates</span></a>
<a class="sourceLine" id="cb4-74" title="74"><span class="co">#&gt;              pool1 pool2 pool3 pool4  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb4-75" title="75"><span class="co">#&gt; pool1          5.3   6.4   4.2   5.3 59.9    0.001        3.5   14291</span></a>
<a class="sourceLine" id="cb4-76" title="76"><span class="co">#&gt; pool2          8.7   7.9   6.2   5.9 23.1    0.000        0.0       0</span></a>
<a class="sourceLine" id="cb4-77" title="77"><span class="co">#&gt; est unmarked    NA    NA    NA    NA  0.0       NA         NA   13499</span></a>
<a class="sourceLine" id="cb4-78" title="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-79" title="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-80" title="80"><span class="co">#&gt; Chisquare gof cutoff  : 0.1 </span></a>
<a class="sourceLine" id="cb4-81" title="81"><span class="co">#&gt; Chisquare gof value   : 33.49443 </span></a>
<a class="sourceLine" id="cb4-82" title="82"><span class="co">#&gt; Chisquare gof df      : 2 </span></a>
<a class="sourceLine" id="cb4-83" title="83"><span class="co">#&gt; Chisquare gof p       : 5.33061e-08</span></a>
<a class="sourceLine" id="cb4-84" title="84"></a>
<a class="sourceLine" id="cb4-85" title="85"><span class="co"># Compute the condition number of XX&#39;</span></a>
<a class="sourceLine" id="cb4-86" title="86"></a>
<a class="sourceLine" id="cb4-87" title="87">XX &lt;-<span class="st"> </span>test.data[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(test.data[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb4-88" title="88">XX</a>
<a class="sourceLine" id="cb4-89" title="89"><span class="co">#&gt;       [,1]  [,2]</span></a>
<a class="sourceLine" id="cb4-90" title="90"><span class="co">#&gt; [1,] 51908 25046</span></a>
<a class="sourceLine" id="cb4-91" title="91"><span class="co">#&gt; [2,] 25046 12138</span></a>
<a class="sourceLine" id="cb4-92" title="92"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Condition number is</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb4-93" title="93"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-94" title="94"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-95" title="95"><span class="co">#&gt; Condition number is</span></a>
<a class="sourceLine" id="cb4-96" title="96"><span class="kw">kappa</span>(XX)</a>
<a class="sourceLine" id="cb4-97" title="97"><span class="co">#&gt; [1] 1785.545</span></a></code></pre></div>
<p>Now there is only one solution, but the estimate is very sensitive to small changes in the data. Notice that the condition number is still very large.</p>
</div>
</div>
<div id="columns-that-are-all-zero" class="section level1">
<h1><span class="header-section-number">2</span> Columns that are all zero</h1>
<p>In theory this should have no influence on the fit (see the section on pooling columns).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"></a>
<a class="sourceLine" id="cb5-2" title="2">test.data.csv &lt;-<span class="st"> </span><span class="kw">textConnection</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st"> 160   ,   120   ,     72   ,     82   ,   0, 3592</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st"> 100   ,    45   ,     39   ,     90   ,   0,  532</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">7960   ,  9720   ,   6264   ,   7934   ,   0,    0  &quot;</span>)</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7">test.data &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(test.data.csv, <span class="dt">header=</span><span class="ot">FALSE</span>, <span class="dt">strip.white=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb5-8" title="8">test.data</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt;        V1   V2   V3   V4 V5   V6</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; [1,]  160  120   72   82  0 3592</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; [2,]  100   45   39   90  0  532</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; [3,] 7960 9720 6264 7934  0    0</span></a>
<a class="sourceLine" id="cb5-13" title="13"></a>
<a class="sourceLine" id="cb5-14" title="14">mod..<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">SPAS.fit.model</span>(test.data,</a>
<a class="sourceLine" id="cb5-15" title="15">                       <span class="dt">model.id=</span><span class="st">&quot;No restrictions&quot;</span>,</a>
<a class="sourceLine" id="cb5-16" title="16">                       <span class="dt">row.pool.in=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">col.pool.in=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; Using nlminb to find conditional MLE</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; outer mgc:  19793.78 </span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; outer mgc:  31172.76 </span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; outer mgc:  29040.42 </span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt; outer mgc:  25712.46 </span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; outer mgc:  5362.637 </span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt; outer mgc:  496.3737 </span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; outer mgc:  8.392982 </span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt; outer mgc:  0.2236606 </span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt; outer mgc:  0.1492354 </span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt; outer mgc:  0.05639175 </span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt; outer mgc:  0.02111307 </span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt; outer mgc:  0.007818906 </span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#&gt; outer mgc:  0.002723444 </span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="co">#&gt; outer mgc:  0.0009406725 </span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt; Convergence codes from nlminb  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; Finding conditional estimate of N</span></a>
<a class="sourceLine" id="cb5-34" title="34"></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="kw">SPAS.print.model</span>(mod..<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-36" title="36"><span class="co">#&gt; Model Name: No restrictions </span></a>
<a class="sourceLine" id="cb5-37" title="37"><span class="co">#&gt;    Date of Fit: 2019-11-29 23:00 </span></a>
<a class="sourceLine" id="cb5-38" title="38"><span class="co">#&gt;    Version of OPEN SPAS used : SPAS-R 2020-01-01 </span></a>
<a class="sourceLine" id="cb5-39" title="39"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="co">#&gt; Raw data </span></a>
<a class="sourceLine" id="cb5-41" title="41"><span class="co">#&gt;        V1   V2   V3   V4 V5   V6</span></a>
<a class="sourceLine" id="cb5-42" title="42"><span class="co">#&gt; [1,]  160  120   72   82  0 3592</span></a>
<a class="sourceLine" id="cb5-43" title="43"><span class="co">#&gt; [2,]  100   45   39   90  0  532</span></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="co">#&gt; [3,] 7960 9720 6264 7934  0    0</span></a>
<a class="sourceLine" id="cb5-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-46" title="46"><span class="co">#&gt; Row pooling setup : 1 2 </span></a>
<a class="sourceLine" id="cb5-47" title="47"><span class="co">#&gt; Col pooling setup : 1 2 3 4 5 </span></a>
<a class="sourceLine" id="cb5-48" title="48"><span class="co">#&gt; Physical pooling  : TRUE </span></a>
<a class="sourceLine" id="cb5-49" title="49"><span class="co">#&gt; Theta pooling     : FALSE </span></a>
<a class="sourceLine" id="cb5-50" title="50"><span class="co">#&gt; CJS pooling       : FALSE </span></a>
<a class="sourceLine" id="cb5-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-52" title="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-53" title="53"><span class="co">#&gt; Chapman estimator of population size  222133  (SE  7617  )</span></a>
<a class="sourceLine" id="cb5-54" title="54"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb5-55" title="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-56" title="56"><span class="co">#&gt; Raw data AFTER PHYSICAL (but not logical) POOLING </span></a>
<a class="sourceLine" id="cb5-57" title="57"><span class="co">#&gt;       pool1 pool2 pool3 pool4 pool5   V6</span></a>
<a class="sourceLine" id="cb5-58" title="58"><span class="co">#&gt; pool1   160   120    72    82     0 3592</span></a>
<a class="sourceLine" id="cb5-59" title="59"><span class="co">#&gt; pool2   100    45    39    90     0  532</span></a>
<a class="sourceLine" id="cb5-60" title="60"><span class="co">#&gt;        7960  9720  6264  7934     0    0</span></a>
<a class="sourceLine" id="cb5-61" title="61"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-62" title="62"><span class="co">#&gt; Condition number of XX&#39; where X= (physically) pooled matrix is  46.8607 </span></a>
<a class="sourceLine" id="cb5-63" title="63"><span class="co">#&gt; Condition number of XX&#39; after logical pooling                   46.8607 </span></a>
<a class="sourceLine" id="cb5-64" title="64"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-65" title="65"><span class="co">#&gt; Large value of kappa (&gt;1000) indicate that rows are approximately proportional which is not good</span></a>
<a class="sourceLine" id="cb5-66" title="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-67" title="67"><span class="co">#&gt;   Conditional   Log-Likelihood: 286003.7    ;  np: 14 ;  AICc: -571979.3 </span></a>
<a class="sourceLine" id="cb5-68" title="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-69" title="69"><span class="co">#&gt;   Code/Message from optimization is:  0 relative convergence (4) </span></a>
<a class="sourceLine" id="cb5-70" title="70"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-71" title="71"><span class="co">#&gt; Estimates</span></a>
<a class="sourceLine" id="cb5-72" title="72"><span class="co">#&gt;               pool1  pool2  pool3  pool4 pool5  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb5-73" title="73"><span class="co">#&gt; pool1         109.1  132.2   85.1  107.7     0 3592    0.013       73.5  299742</span></a>
<a class="sourceLine" id="cb5-74" title="74"><span class="co">#&gt; pool2         100.0   45.0   39.0   90.0     0  532    1.000        0.0     806</span></a>
<a class="sourceLine" id="cb5-75" title="75"><span class="co">#&gt; est unmarked 8011.0 9708.0 6251.0 7908.0     0    0       NA         NA  300548</span></a>
<a class="sourceLine" id="cb5-76" title="76"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-77" title="77"><span class="co">#&gt; SE of above estimates</span></a>
<a class="sourceLine" id="cb5-78" title="78"><span class="co">#&gt;              pool1 pool2 pool3 pool4 pool5  psi cap.prob exp factor Pop Est</span></a>
<a class="sourceLine" id="cb5-79" title="79"><span class="co">#&gt; pool1          5.3   6.4   4.2   5.3     0 59.9    0.001        3.5   14291</span></a>
<a class="sourceLine" id="cb5-80" title="80"><span class="co">#&gt; pool2         10.0   6.7   6.2   9.5     0 23.1    0.000        0.0       0</span></a>
<a class="sourceLine" id="cb5-81" title="81"><span class="co">#&gt; est unmarked    NA    NA    NA    NA    NA  0.0       NA         NA   13499</span></a>
<a class="sourceLine" id="cb5-82" title="82"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-83" title="83"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-84" title="84"><span class="co">#&gt; Chisquare gof cutoff  : 0.1 </span></a>
<a class="sourceLine" id="cb5-85" title="85"><span class="co">#&gt; Chisquare gof value   : 33.49436 </span></a>
<a class="sourceLine" id="cb5-86" title="86"><span class="co">#&gt; Chisquare gof df      : 3 </span></a>
<a class="sourceLine" id="cb5-87" title="87"><span class="co">#&gt; Chisquare gof p       : 2.533076e-07</span></a>
<a class="sourceLine" id="cb5-88" title="88"></a>
<a class="sourceLine" id="cb5-89" title="89">XX &lt;-<span class="st"> </span>test.data[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(test.data[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb5-90" title="90">XX</a>
<a class="sourceLine" id="cb5-91" title="91"><span class="co">#&gt;       [,1]  [,2]</span></a>
<a class="sourceLine" id="cb5-92" title="92"><span class="co">#&gt; [1,] 51908 31588</span></a>
<a class="sourceLine" id="cb5-93" title="93"><span class="co">#&gt; [2,] 31588 21646</span></a>
<a class="sourceLine" id="cb5-94" title="94"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Condition number is</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb5-95" title="95"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-96" title="96"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-97" title="97"><span class="co">#&gt; Condition number is</span></a>
<a class="sourceLine" id="cb5-98" title="98"><span class="kw">kappa</span>(XX)</a>
<a class="sourceLine" id="cb5-99" title="99"><span class="co">#&gt; [1] 46.8607</span></a></code></pre></div>
<p>Notice that the column of 0’s does not affect the fit and has no impact on the condition number of <span class="math inline">\(XX&#39;\)</span>.</p>
</div>
<div id="references" class="section level1">
<h1><span class="header-section-number">3</span> References</h1>
<p>Darroch, J. N. (1961). The two-sample capture-recapture census when tagging and sampling are stratified. Biometrika, 48, 241–260. <a href="https://www.jstor.org/stable/2332748" class="uri">https://www.jstor.org/stable/2332748</a></p>
<p>Plante, N., L.-P Rivest, and G. Tremblay. (1988). Stratified Capture-Recapture Estimation of the Size of a Closed Population. Biometrics 54, 47-60. <a href="https://www.jstor.org/stable/2533994" class="uri">https://www.jstor.org/stable/2533994</a></p>
<p>Schwarz, C. J., &amp; Taylor, C. G. (1998). The use of the stratified-Petersen estimator in fisheries management with an illustration of estimating the number of pink salmon (Oncorhynchus gorbuscha) that return to spawn in the Fraser River. Canadian Journal of Fisheries and Aquatic Sciences, 55, 281–296. <a href="https://doi.org/10.1139/f97-238" class="uri">https://doi.org/10.1139/f97-238</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
